\documentclass[a4j]{jarticle}
\input{../preamble}
%\setlength{\jot}{8pt}

\begin{document}
\section{多点多変量ガウス分布と多変量ガウス分布(平均)}
分散共分散行列は固定された状態であることに注意する．
\begin{eqnarray}
\prod_{n=1}^{N}{\N(\boldsymbol{x_n} | \boldsymbol{\mu}, \Sigma)}
\times
\N{(\boldsymbol{\mu} | \boldsymbol{c}, X)}
&\propto&
\prod_{n=1}^{N}{\exp{\left( -\frac{1}{2} \left( \boldsymbol{x_n} - \boldsymbol{\mu}\right)^T \Sigma^{-1} \left( \boldsymbol{x_n} - \boldsymbol{\mu}\right) \right)}}
\times
\exp{\left( -\frac{1}{2} \left( \boldsymbol{\mu} - \boldsymbol{c}\right)^T X^{-1} \left( \boldsymbol{\mu} - \boldsymbol{c}\right) \right)} \nonumber \\
&=&
\exp{\left( -\frac{1}{2}\left\{ \sum_{n=1}^{N}{ \left(\boldsymbol{x_n} - \boldsymbol{\mu}\right)^T \Sigma^{-1} \left( \boldsymbol{x_n} - \boldsymbol{\mu}\right) } + \left( \boldsymbol{\mu} - \boldsymbol{c}\right)^T X^{-1} \left( \boldsymbol{\mu} - \boldsymbol{c}\right) \right\}  \right)}
\end{eqnarray}
ここで，$\exp$の中カッコ$\left\{\cdot\right\}$に囲まれた部分について考えると，
\begin{eqnarray}
\left\{ \cdot \right\}
&=&
\left\{ \sum_{n=1}^{N}{ \left(\boldsymbol{x_n} - \boldsymbol{\mu}\right)^T \Sigma^{-1} \left( \boldsymbol{x_n} - \boldsymbol{\mu}\right) } + \left( \boldsymbol{\mu} - \boldsymbol{c}\right)^T X^{-1} \left( \boldsymbol{\mu} - \boldsymbol{c}\right) \right\} \\
&&\nonumber\\
&=&
\boldsymbol{\mu}^T \left(\sum_{n=1}^{N}{\Sigma^{-1}} + X^{-1}\right)\boldsymbol{\mu} -2\boldsymbol{\mu}^T \left(\sum_{n=1}^{N}{\Sigma^{-1}\boldsymbol{x_n}} + X^{-1}\boldsymbol{c} \right) + Const \\
&& \nonumber \\
&=&
\boldsymbol{\mu}^T \left(N \Sigma^{-1} + X^{-1}\right)\boldsymbol{\mu} -2\boldsymbol{\mu}^T \left(\Sigma^{-1}\sum_{n=1}^{N}{(\boldsymbol{x_n})} + X^{-1}\boldsymbol{c} \right) + Const
\end{eqnarray}
ここで，これが多変量ガウス分布$\N{(\boldsymbol{\mu} | \hat{\boldsymbol{c}} , \hat{X})}$に従うとすると，
\begin{eqnarray}
\N{(\boldsymbol{\mu} | \hat{\boldsymbol{c}} , \hat{X})}
&\propto&
\exp{\left( -\frac{1}{2} \left\{ \left( \boldsymbol{\mu} - \hat{\boldsymbol{c}}\right)^T \hat{X}^{-1} \left( \boldsymbol{\mu} - \hat{\boldsymbol{c}}\right) \right\} \right)}
\end{eqnarray}
先と同様に$\left\{\cdot\right\}$の部分について考えると
\begin{eqnarray}
\left\{\cdot\right\} &=& \left\{ \left( \boldsymbol{\mu} - \hat{\boldsymbol{c}}\right)^T \hat{X}^{-1} \left( \boldsymbol{\mu} - \hat{\boldsymbol{c}}\right) \right\} \\
&=&
\boldsymbol{\mu}^T \hat{X}^{-1}\boldsymbol{\mu} -2\boldsymbol{\mu}^T \hat{X}^{-1}\hat{\boldsymbol{c}} + Const
\end{eqnarray}
ここで，式を見比べると，
\begin{eqnarray}
\hat{X}^{-1} &=& N \Sigma^{-1} + X^{-1}\\
\hat{X}^{-1}\hat{\boldsymbol{c}} &=& \Sigma^{-1}\sum_{n=1}^{N}{(\boldsymbol{x_n})} + X^{-1}\boldsymbol{c}
\end{eqnarray}
より，
\begin{eqnarray}
\hat{X} &=& \left( N \Sigma^{-1} + X^{-1} \right)^{-1}\\
\hat{\boldsymbol{c}} &=& \hat{X}\left(\Sigma^{-1}\sum_{n=1}^{N}{(\boldsymbol{x_n})} + X^{-1}\boldsymbol{c} \right)\\
&=& \left( N \Sigma^{-1} + X^{-1} \right)^{-1} \left(\Sigma^{-1}\sum_{n=1}^{N}{(\boldsymbol{x_n})} + X^{-1}\boldsymbol{c} \right)
\end{eqnarray}
よって，
\begin{screen}
\begin{eqnarray}
\prod_{n=1}^{N}{\N{(\boldsymbol{x_n} | \boldsymbol{\mu}, \Sigma)}}
\times
\N{(\boldsymbol{\mu} | \boldsymbol{c}, X)}
&\propto&
\N{(\boldsymbol{\mu} | \hat{\boldsymbol{c}}, \hat{X})}
\end{eqnarray}
ただし，
\begin{eqnarray}
\hat{X} &=& \left( N \Sigma^{-1} + X^{-1} \right)^{-1}\\
\hat{\boldsymbol{c}} &=& \hat{X}\left(\Sigma^{-1}\sum_{n=1}^{N}{(\boldsymbol{x_n})} + X^{-1}\boldsymbol{c} \right)\\
&=& \left( N \Sigma^{-1} + X^{-1} \right)^{-1} \left(\Sigma^{-1}\sum_{n=1}^{N}{(\boldsymbol{x_n})} + X^{-1}\boldsymbol{c} \right)
\end{eqnarray}
\end{screen}
\end{document}